


<div class="row ">
    <div class="col-2 m-2">
        <a data-bs-toggle="collapse" href="#collapseExample1" role="button" aria-expanded="false"
            aria-controls="collapseExample1" [ngClass]="lang == 'en' ? 'hrefbutton': 'hrefbuttonAr'">
            <i class="bi bi-funnel"></i> {{'UPA.Filter'|translate}}</a>
    </div>
    <div class="col-10">
        <!-- <h4 class="card-title"> {{'UPA.GenericReport'|translate}} </h4> -->
    </div>
 
</div>


    
    <div class="row">
        
        <div class="col-12">
            <div class="card">
                
                <div class="collapse" id="collapseExample1">
                    <div class="card-body">
                       

                            <!-- Row 1 -->
                            <div class="row">
                                <div class="col-3">
                                    <ng-multiselect-dropdown appendTo="body" [placeholder]="'UPA.Governorate'|translate"
                                    [settings]="dropdownSettings" [data]="govList" [(ngModel)]="selectedItems"
                                    (onSelect)="onItemSelect($event)" (onSelectAll)="onSelectAll($event)"
                                    (onDeSelect)="onItemDeselect($event)" (onDeSelectAll)="onDeselectAll($event)">
                                </ng-multiselect-dropdown>
                                </div>
                                <div class="col-3">
                                    <ng-multiselect-dropdown appendTo="body"
                                    [placeholder]="'UPA.Hospital'|translate" [settings]="dropdownSettings" [data]="lstHosp"
                                    [(ngModel)]="selectedHospitalItems" (onSelect)="onHospitalSelect($event)"
                                    (onSelectAll)="onHospitalSelectAll($event)" (onDeSelect)="onHospitalDeselect($event)"
                                    (onDeSelectAll)="onHospitalDeselectAll($event)">
                                </ng-multiselect-dropdown>
                                </div>
                                <div class="col-3">
                                    <ng-multiselect-dropdown    appendTo="body" [placeholder]="'UPA.Organization'|translate"
                                    [settings]="dropdownSettings" [data]="lstOrganization" [(ngModel)]="selectedOrgItems"
                                    (onSelect)="onOrgSelect($event)" (onSelectAll)="onOrgSelectAll($event)"
                                    (onDeSelect)="onOrgDeselect($event)" (onDeSelectAll)="onOrgDeselectAll($event)">
                                </ng-multiselect-dropdown>
                                </div>
            
                                <div class="col-3">
                                    <ng-multiselect-dropdown    appendTo="body" [placeholder]="'UPA.SubOrganization'|translate"
                                    [settings]="dropdownSettings" [data]="subList" [(ngModel)]="selectedSubOrgItems"
                                    (onSelect)="onSubOrgSelect($event)" (onSelectAll)="onSubOrgSelectAll($event)"
                                    (onDeSelect)="onSubOrgDeselect($event)" (onDeSelectAll)="onSubOrgDeselectAll($event)">
                                </ng-multiselect-dropdown>
                                </div>
                            </div>

                            <!-- Row 2 -->
                            <div class="row mt-2">
                                <div class="col-3">
                                    <ng-multiselect-dropdown class="custom-dropdown-width"
                                    [placeholder]="'UPA.Name'|translate" [settings]="dropdownSettingsName" [data]="lstAssets2"
                                    [(ngModel)]="selectedNameItems" (onSelect)="onNameSelect($event)"
                                    (onSelectAll)="onNameSelectAll($event)" (onDeSelect)="onNameDeselect($event)"
                                    (onDeSelectAll)="onNameDeselectAll($event)">
                                </ng-multiselect-dropdown>
                                </div>
                                <div class="col-3">
                                   
                                    <ng-multiselect-dropdown appendTo="body"
                                    [placeholder]="'UPA.Brand'|translate" [settings]="dropdownSettings" [data]="lstBrands"
                                    [(ngModel)]="selectedBrandItems" (onSelect)="onBrandSelect($event)"
                                    (onSelectAll)="onBrandSelectAll($event)" (onDeSelect)="onBrandDeselect($event)"
                                    (onDeSelectAll)="onBrandDeselectAll($event)">      </ng-multiselect-dropdown>
                                </div>
                                <div class="col-3">
                                    <ng-multiselect-dropdown appendTo="body"
                                    [placeholder]="'UPA.Model'|translate" [settings]="dropdownSettingsModel"
                                    [data]="lstMasterAssets5" [(ngModel)]="selectedModelItems"
                                    (onSelect)="onModelSelect($event)" (onSelectAll)="onModelSelectAll($event)"
                                    (onDeSelect)="onModelDeselect($event)" (onDeSelectAll)="onModelDeselectAll($event)">
                                </ng-multiselect-dropdown>
                                </div>
                                <div class="custom-background col-3">
                                    <mat-form-field>
                                        <mat-label class="">Enter a date range</mat-label>
                                        <mat-date-range-input [rangePicker]="picker">
                                            <input matStartDate placeholder="Start date" [(ngModel)]="startDate"
                                                (dateChange)="onStartDateChange($event)">
                                            <input matEndDate placeholder="End date" [(ngModel)]="endDate"
                                                (dateChange)="onEndDateChange($event)">
                                        </mat-date-range-input>
                                        <!-- <mat-hint>MM/DD/YYYY – MM/DD/YYYY</mat-hint> -->
                                        <mat-datepicker-toggle matIconSuffix [for]="picker"></mat-datepicker-toggle>
                                        <mat-date-range-picker #picker></mat-date-range-picker>
                                    </mat-form-field>
                                </div>
                            </div>

                            <!-- Row 3 -->
                            <form (ngSubmit)="onFilter()"#form="ngForm">
                                <div class="row">
                                    <div class="col-5" >
                              
                                        
                                            <div class="card-body"style="margin:0 !important ;padding: 5px !important;" >
                                                <p class="text-center text-white" style="margin:0 !important ;">{{this.lang === 'en' ? "Search By Age of Asset" : "البحث بعمر الجهاز"}}</p>
                                                <div class="row">
                                                    <div class="col-3">
                                                        <label for="minAgeByYear" style="text-align: left;" >{{this.lang=='en'?"Min Years":"اقل عمر بالسنة"}}</label>
                                                        <input type="number" class="form-control" name="minAgeByYear" id="minAgeByYear" [(ngModel)]="minAgeByYear" />
                                                    </div>
                                                    <div class="col-3" >
                                                        <label for="minAgeByMonth">{{this.lang=='en'?"Min Months":"اقل عمر بالشهر"}}</label>
                                                        <input type="number" class="form-control" name="minAgeByMonth" id="minAgeByMonth" [(ngModel)]="minAgeByMonth" />
                                                    </div>
                                                    <div class="col-3" >
                                                        <label for="maxAgeByYear" >{{this.lang=='en'?"Max Years":"اكبر عمر بالسنة"}}</label>
                                                        <input type="number" class="form-control" name="maxAgeByYear" id="maxAgeByYear"  [(ngModel)]="maxAgeByYear" />
                                                    </div>
                                                
                                                    <div class="col-3">
                                                        <label for="maxAgeByMonth">{{this.lang=='en'?"Max Months":"اكبر عمر بالشهر"}}</label>
                                                        <input type="number" class="form-control" name="maxAgeByMonth" id="maxAgeByMonth" [(ngModel)]="maxAgeByMonth" />
                                                    </div>
                                                </div>
                                            </div>
                                        
                                    </div>
                                   
                                        <div class="col-3">
                                     <div class="card-body" style="margin: 0px !important; padding: 5px !important; ">
                                        <p class="text-center text-white" style="margin:0 !important">{{this.lang === 'en' ? "Search By Expected Life Time" : "البحث بالعمر الافتراضى للجهاز"}}</p>
                                        <div class="d-flex justify-content-around">
                                         
                                            <div class="">
                                         
                                                <label for="minExpectedLife" class="">{{this.lang=='en'?"Min Expected Life":"اقل عمر افتراضى بالسنة"}} </label>
                                                <input type="number" name="minExpectedLife" style="width:100px"id="minAge" class="form-control"[(ngModel)]="minExpectedLife" />
                                            </div>
                                            <div class="">
                                                <label for="maxExpectedLife">{{this.lang=='en'?"Max Expected Life":"اكبر عمر افتراضى بالسنة"}}</label>
                                                <input type="number"name="maxExpectedLife"  style="width:100px"id="maxAge" class="form-control" [(ngModel)]="maxExpectedLife" />
                                              
                                                <!-- <button (click)="filterByAge()">Filter</button> -->
                                              </div>
                                            
                                          
                                 
                              
                                </div>
                                     </div>
                                        
                                        
                                     
                                    </div>
                                    <div class="col-4">
                                     <div class="d-flex justify-content-around">
                                        <div >
                                            <button class="btn btn-success" type="submit">{{this.lang=='en'?"Apply Filters":"تطبيق البحث"}}</button>
                                           
                                        </div>
                                        <div class="">
                                            
                                            <button class="btn btn-danger" type="button" (click)="clearSearch()">{{this.lang=='en'?"Reset":"إالغاء المحددات"}}</button>
                                        </div>
                                     </div>
                                           
                                  
                                    </div>
                                </div>
                              


<div class="text-danger text-center" *ngIf="showAlert">
   {{alert}}
</div>






                          
                            <!-- Action Buttons -->
                          

                        </form>
                    </div>
                </div>
            </div>
        </div>
        </div>




<div style="width:99%; margin: auto;">
    <div class="card-list my-component"  >


        <p-table class="" #dt styleClass="custom-p-table p-datatable-sm p-datatable-striped p-datatable-gridlines" showGridlines="true"
            [value]="lstAssets" [paginator]="true" [lazy]="true" [rows]="10" [totalRecords]="count" pageLinks="10"
            (onLazyLoad)="clicktbl($event)" dataKey="id" [rowHover]="true" >
            <ng-template pTemplate="header">
                <tr>
                 
    <!--            
                    
              
                    <th [sortable]="true"></th>
    
                    <th [sortable]="true"> <ng-multiselect-dropdown appendTo="body"
                            [placeholder]="'UPA.Brand'|translate" [settings]="dropdownSettings" [data]="lstBrands"
                            [(ngModel)]="selectedBrandItems" (onSelect)="onBrandSelect($event)"
                            (onSelectAll)="onBrandSelectAll($event)" (onDeSelect)="onBrandDeselect($event)"
                            (onDeSelectAll)="onBrandDeselectAll($event)">
                        </ng-multiselect-dropdown> </th>
                    <th [sortable]="true"> <ng-multiselect-dropdown appendTo="body"
                            [placeholder]="'UPA.Model'|translate" [settings]="dropdownSettingsModel"
                            [data]="lstMasterAssets5" [(ngModel)]="selectedModelItems"
                            (onSelect)="onModelSelect($event)" (onSelectAll)="onModelSelectAll($event)"
                            (onDeSelect)="onModelDeselect($event)" (onDeSelectAll)="onModelDeselectAll($event)">
                        </ng-multiselect-dropdown></th>
         
                        
    
                        <th>
                        
    
                        </th>
                        <th [sortable]="true"> </th>
                        <th [sortable]="true"> </th> -->
                <!-- <th> <div >
                        <a class="btn resetIcon" (click)="  clearSearch()" [title]="lang=='en'? 'reset search':'إلغاء البحث'" >
                            <i class="fa-solid fa-x "></i></a>
                    </div></th> -->
                </tr>
                <tr>
                  
                    <th [sortable]="true">{{'UPA.AssetName'|translate}} <p-sortIcon id="{{'UPA.AssetName' | translate}}"
                            (click)="sortAfterSearch($event)" style="cursor: pointer;"> </p-sortIcon></th>
                    <th [sortable]="true">{{'UPA.Brand'|translate}} <p-sortIcon id="{{'UPA.Brand' | translate}}"
                            (click)="sortAfterSearch($event)" style="cursor: pointer;"> </p-sortIcon></th>
                    <th [sortable]="true">{{'UPA.Model'|translate}} <p-sortIcon id="{{'UPA.Model' | translate}}"
                            (click)="sortAfterSearch($event)" style="cursor: pointer;"> </p-sortIcon></th>
                    <th [sortable]="true">{{'UPA.InstallationDate'|translate}} <p-sortIcon
                            id="{{'UPA.InstallationDate' | translate}}" (click)="sortAfterSearch($event)"
                            style="cursor: pointer;"> </p-sortIcon></th>
                            <th [sortable]="true">{{'UPA.AssetAge'|translate}} <p-sortIcon
                                id="{{'UPA.AssetAge' | translate}}" (click)="sortAfterSearch($event)"
                                style="cursor: pointer;"> </p-sortIcon></th>
                                <th [sortable]="true">{{'UPA.ExpectedLife'|translate}} <p-sortIcon
                                    id="{{'UPA.ExpectedLife' | translate}}" (click)="sortAfterSearch($event)"
                                    style="cursor: pointer;"> </p-sortIcon></th>
                    
                </tr>
            </ng-template>
            <ng-template pTemplate="body" let-item >
                <tr >
                    <!-- <td><input (change)="onCheckboxChange($event, item)" [checked]="isSelected(item)"
                            class="checkbox-input" type="checkbox" style="background-color: aqua; color: aqua;"
                            [value]="item.id"></td> -->
    
                
                    <td>{{ lang=="en" ?item.assetName:item.assetNameAr }}</td>
                    <td>{{ lang=="en" ?item.brandName:item.brandNameAr }}</td>
                    <td>{{ item.model }}</td>
                    <td [ngClass]="{'highlight-non':item.installationDate==null}">{{ item.installationDate | date:"yyyy-MM-dd"}}</td>
                    <td *ngIf="item.ageOfAsset !== null && item.ageOfAsset !== undefined" [ngClass]="{'highlight-row': item.ageOfAsset / 12> item.expectedLifeTime &&item.expectedLifeTime>0 &&item.ageOfAsset>0, 'highlight-row-equal': item.ageOfAsset / 12 === item.expectedLifeTime&&item.expectedLifeTime>0 &&item.ageOfAsset>0, 'highlight-row-less': item.ageOfAsset / 12< item.expectedLifeTime&&item.expectedLifeTime>0 &&item.ageOfAsset>0}"> 
                        <ng-container *ngIf="item.ageOfAsset>0">
                               {{
         checkAssetAge(item.ageOfAsset)
        }}
                          </ng-container></td>
                    
                      <td *ngIf="item.ageOfAsset === null || item.ageOfAsset === undefined">N/A</td>
                    <td class="text-center">{{ item.expectedLifeTime}}</td>
              
          
                </tr>
            </ng-template>
    
        </p-table>
    </div>
</div>


